# Paternalmito----Matlab codes for imaging analysis related to paternal mitochondria

---Analysis1:Tracking of the posterior boundary of NMY-2::GFP and paternal mitochondria in the zygote
We used a three-step analysis of two-channel time-lapse movies to track the average X coordinates (along the A-P axis) of paternal mitochondria and the X coordinates of the posterior boundary of NMY-2::GFP patches in each embryo. 
1)Custom Matlab codes (analysis1_step1) were used to generate the weighted average X coordinates of green (NMY-2::GFP) pixels and red (paternal mitochondria) pixels for all frames in each embryo. 
2)The X coordinates of the weighted average of green pixels in each frame were converted to the X coordinates of the posterior boundary of NMY-2::GFP patches with Matlab codes (analysis1_step2). The assumption here is that the relative position of the center point remains unchanged, where the relative position is defined as the ratio of the distance between the center point and the posterior boundary to the distance between the posterior boundary and the anterior boundary. The X coordinates of paternal mitochondria and the posterior boundary of NMY-2::GFP were then converted from pixel units to percentages of egg length along the A-P axis, with 0% and 100% representing the posterior and anterior edges of the egg, respectively. For this conversion, the X coordinates in pixel units for the posterior and anterior edges of each egg were manually determined based on the DIC channel in Fiji, and the results were saved in videoinfo.csv. This file, and the results from step1, were input into Matlab for analysis1_step2. 
3)The X coordinates of paternal mitochondria and the posterior boundary of NMY-2::GFP patches, in the unit of % egg length, for each frame of each embryo with the same genetic background were summarized in Matlab (analysis1_step3).


---Analysis2: Calculation of average velocities of paternal mitochondria and NMY-2 cortical flow in the zygote
The double-channel movies showing both paternal mitochondria (red) and NMY-2::GFP (green) were split into single-channel movies for the separate initial analyses of velocities. The analyses of paternal mitochondria velocity and NMY-2::GFP cortical flow velocity were first performed in the Fiji plugin Trackmate and Matlab toolbox PIVlab, respectively. The data from Trackmate and PIVlab were then analyzed and combined using custom Matlab codes (analysis2). 
For the initial analysis of paternal mitochondria trajectories using Trackmate, the red-channel movie of paternal mitochondria was first converted to 8-bit format and calibrated in Fiji. The DoG detector was chosen in Trackmate, with an estimated object diameter of 1 μM. The detected spots were filtered using auto thresholding. The Simple LAP tracker was then used with the following settings: Linking max distance: 15 μM; Gap-closing max distance: 15 μM; Gap-closing max frame gap: 2. In the results display window, ‘Spots’ in the ‘Track tables’ were sorted based on ‘Track ID’ and ‘frame’ and were exported in the format of ‘spot.csv’, which were used in the downstream analysis in Matlab. The overlay of paternal mitochondria trajectories was then exported as movies, which was used to create a mask in PIVlab analysis of NMY-2::GFP flow of the same embryo.
For the initial analysis of NMY-2::GFP cortical flow velocity, we first drew a mask in PIVlab for the time-lapse movie of each embryo based on the trajectories of paternal mitochondria generated by Trackmate, so that only the unmasked NMY-2::GFP signals in the region with paternal mitochondria movement were analyzed. After the mask was applied to all frames of the NMY-2::GFP (green) channel, ‘Enable CLACHE’ was chosen in ‘Pre-procssing’ to increase the contrast of the movie. The Fast Fourier transformation (FFT) window deformation was chosen as the PIV algorithm. The PIV analysis was performed using a 3-step multi-pass, 64 × 64 pixels, 32 × 32 pixels, and the final interrogation window of 16 × 16 pixels with 50% overlap. The vector profiles generated using PIV gave us information about the direction and magnitude of the NMY-2::GFP foci movements. The vector fields across time were generated from each frame of every single embryo, and were exported into Matlab for downstream analysis. 
Using custom Matlab codes (analysis2),  ‘Spots’ data generated by Trackmate, and vector fields generated by PIVlab, we calculated the average velocities of paternal mitochondria (mito_u) and the average velocities of NMY-2::GFP (flow_u) along the A-P axis in the ROI (region of interest, area of paternal mitochondria trajectories overlay) from each frame to its subsequent frame. The spatially averaged velocities were then averaged over all time frames for each embryo.  

---Analysis3:summarizing the average distance between paternal mitochondria and MTOCs per embryo across time
The average values of paternal mitochondria-MTOC distances per embryo as a function of time were calculated and plotted using custom Matlab codes (analysis3) 

---Analysis4:Tracking the movements of paternal mitochondria and MTOCs during metaphase and anaphase of zygotes
We used a three-step analysis of two-channel time-lapse movies to track the average X coordinates (along the A-P axis) of paternal mitochondria and the X coordinates of the MTOCs labeled by EBP-2::GFP in each zygote. Because the two MTOCs at metaphase moved towards the posterior and anterior ends of the embryos, respectively, each movie (700 x 462 pixels) was split into two halves, measuring 350 x 462 pixels each, in Fiji. This division allowed separate analysis of the posterior and anterior parts of the embryo. 
1)Custom Matlab codes (analysis4_step1) were used to generate the weighted average X coordinates of green (EBP-2::GFP) pixels and red (paternal mitochondria) pixels for all frames in each posterior or anterior-half movie. Because the majority of EBP-2::GFP protein was concentrated at the MTOCs, the weighted average of green pixels faithfully represented the weighted average of MTOCs. 
2)The X coordinates of paternal mitochondria and the MTOCs were converted from pixel units to percentages of egg length along the A-P axis, with 0% and 100% representing the posterior and anterior edges of the egg, respectively. The X coordinates ranged from 0% to 50% egg length, and 50% to 100% egg length in posterior and anterior-half movies, respectively. For this conversion, the X coordinates in pixel units for the posterior and anterior edges of each egg were manually determined based on the DIC channel in Fiji, and the results were saved in videoinfo.csv. This file, and the results from step1, were input into Matlab (analysis4_step2p for posterior-half movies, and analysis4_step2a for anterior-half movies). 
3)The X coordinates of paternal mitochondria and MTOCs, in the unit of % egg length, for each frame of each embryo with the same genetic background were summarized in Matlab (analysis4_step3).

---Analysis5: Calculation of Mander’s coefficient of MTR (red) and DNC-1::mNG (green) before the shuffling (M1raw) and after the shuffling (M1shuffled) of pixels in the green channel. 
To use this app:
1) Open and run the analysis5_pmcoloc.mlapp in Matlab
2) In 'path', specify the input folder that contains the two-channel (red and green) tif images to be analyzed.
3) Click 'Load Image' to select and import the image to be analyzed.
4) Click on the spot of interest on the imported image to set the top-left corner of the ROI, the coordinates of this spot will be shown in the app as 'Starting X' and 'Starting Y' in the unit of pixels. Then specify the ROI size by inputting 'Width delta X' and 'Height delta Y' in the units of pixels. The width and height of the ROI do not need to be the same. Then click 'Set ROI', and the ROI selected will be outlined in yellow. 
5) Input 'Red Threshold', 'Green Threshold', and 'Random Seed', then click 'Analysis'.The app will randomly shuffle the pixels in the green channel, and calculate Mander's coefficient before and after the shuffling. The shuffling results could be different when inputting different random seeds, so it's recommended to choose the same random seed for different samples of the same experiment. 
6) Mander's coefficients are shown in the 'Result' window. The app also automatically copies to the clipboard the N of pixels above the red threshold, N of pixels above the green threshold, N of pixels above both thresholds before shuffling, and N of pixels above both thresholds after shuffling. These four values can be directly pasted into software like Excel for downstream analysis. 
